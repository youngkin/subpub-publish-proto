[{publish_proto, [
  {amqp, [
    {reconnect_wait_millis, 2000},
    {consumer_prefetch_count, 50},
    {confirmed_publishing, false},
    %% RabbitMQ running in a local VM
    {broker_address, "192.168.56.31"}
    %% RabbitMQ running into Rabbit's "tracer" tool
%%     {broker_address, "localhost"}
    %% RabbitMQ running on stg-usw2c-pr-29-subpubpf-ramq-0003
%%      {broker_address, "10.199.23.211"}
  ]},
  
  {publishing_pool_size, 5},
  {inter_publish_pause_millis, 1},
  {subscriber_timeout_millis, 600000},
  {stats_collection_interval_millis, 5000},
  
  %% no subscriber headers => []
  %% 9 active subs, 4 inactive subs
  {subscriber_headers, [
    [{<<"MessageType">>, binary, <<"Some.Msg.Type">>}, {<<"x-match">>, longstr, <<"all">>}],
    
    [{<<"MessageType">>, binary, <<"Ignore.This">>}, {<<"x-match">>, longstr, <<"all">>}],
    
    [{<<"MessageType">>, binary, <<"Ignore.This.2">>}, {<<"x-match">>, longstr, <<"all">>}],
    
    [{<<"MessageType">>, binary, <<"Ignore.This.3">>}, {<<"x-match">>, longstr, <<"all">>}],
    
    [{<<"MessageType">>, binary, <<"Ignore.This.4">>}, {<<"x-match">>, longstr, <<"all">>}],
    
    [{<<"MessageType">>, binary, <<"Some.Msg.Type">>}, {<<"SubSystem">>, binary, <<"Dragnet">>},
      {<<"System">>, binary, <<"Cronica">>}, {<<"ClientString">>, binary, <<"kaplan">>},
      {<<"Client">>, binary, <<"404310">>}, {<<"UserId">>, binary, <<"31674242">>},
      {<<"CourseId">>, binary, <<"11008988">>}, {<<"x-match">>, longstr, <<"all">>}],
    
    [{<<"MessageType">>, binary, <<"Some.Msg.Type">>}, {<<"SubSystem">>, binary, <<"Dragnet">>},
      {<<"System">>, binary, <<"Cronica">>}, {<<"ClientString">>, binary, <<"kaplan">>},
      {<<"Client">>, binary, <<"404310">>}, {<<"UserId">>, binary, <<"31674242">>},
      {<<"CourseId">>, binary, <<"11008988">>}, {<<"x-match">>, longstr, <<"all">>}],
    
    [{<<"MessageType">>, binary, <<"Some.Msg.Type">>}, {<<"SubSystem">>, binary, <<"Dragnet">>},
      {<<"System">>, binary, <<"Cronica">>}, {<<"ClientString">>, binary, <<"kaplan">>},
      {<<"Client">>, binary, <<"404310">>}, {<<"UserId">>, binary, <<"31674242">>},
      {<<"CourseId">>, binary, <<"11008988">>}, {<<"x-match">>, longstr, <<"all">>}],
    
    [{<<"MessageType">>, binary, <<"Some.Msg.Type">>}, {<<"SubSystem">>, binary, <<"Dragnet">>},
      {<<"System">>, binary, <<"Cronica">>}, {<<"ClientString">>, binary, <<"kaplan">>},
      {<<"Client">>, binary, <<"404310">>}, {<<"UserId">>, binary, <<"31674242">>},
      {<<"CourseId">>, binary, <<"11008988">>}, {<<"x-match">>, longstr, <<"all">>}],
    
    [{<<"MessageType">>, binary, <<"Some.Msg.Type">>}, {<<"SubSystem">>, binary, <<"Dragnet">>},
      {<<"System">>, binary, <<"Cronica">>}, {<<"ClientString">>, binary, <<"kaplan">>},
      {<<"Client">>, binary, <<"404310">>}, {<<"UserId">>, binary, <<"31674242">>},
      {<<"CourseId">>, binary, <<"11008988">>}, {<<"x-match">>, longstr, <<"all">>}],
    
    [{<<"MessageType">>, binary, <<"Some.Msg.Type">>}, {<<"SubSystem">>, binary, <<"Dragnet">>},
      {<<"System">>, binary, <<"Cronica">>}, {<<"ClientString">>, binary, <<"kaplan">>},
      {<<"Client">>, binary, <<"404310">>}, {<<"UserId">>, binary, <<"31674242">>},
      {<<"CourseId">>, binary, <<"11008988">>}, {<<"x-match">>, longstr, <<"all">>}],
    
    [{<<"MessageType">>, binary, <<"Some.Msg.Type">>}, {<<"SubSystem">>, binary, <<"Dragnet">>},
      {<<"System">>, binary, <<"Cronica">>}, {<<"ClientString">>, binary, <<"kaplan">>},
      {<<"Client">>, binary, <<"404310">>}, {<<"UserId">>, binary, <<"31674242">>},
      {<<"CourseId">>, binary, <<"11008988">>}, {<<"x-match">>, longstr, <<"all">>}],
    
    [{<<"MessageType">>, binary, <<"Some.Msg.Type">>}, {<<"SubSystem">>, binary, <<"Dragnet">>},
      {<<"System">>, binary, <<"Cronica">>}, {<<"ClientString">>, binary, <<"kaplan">>},
      {<<"Client">>, binary, <<"404310">>}, {<<"UserId">>, binary, <<"31674242">>},
      {<<"CourseId">>, binary, <<"11008988">>}, {<<"x-match">>, longstr, <<"all">>}]
  ] },

  %% Small header
  %% [{<<"MessageType">>, binary, <<"Some.Msg.Type">>}, {<<"x-match">>, longstr, <<"all">>}];
  {publish_header, [
    {<<"MessageType">>, binary, <<"Some.Msg.Type">>}, {<<"SubSystem">>, binary, <<"Dragnet">>},
    {<<"System">>, binary, <<"Cronica">>}, {<<"ClientString">>, binary, <<"kaplan">>},
    {<<"Client">>, binary, <<"404310">>}, {<<"UserId">>, binary, <<"31674242">>},
    {<<"CourseId">>, binary, <<"11008988">>}, {<<"x-match">>, longstr, <<"all">>}] 
  }

]
},

  {lager, [
    {colored, false},
    {error_logger_hwm, 200}
%%     {handlers, [
%%       {lager_console_backend, info},
%%       {lager_file_backend, [{file, "log/errorTest.log"}, {level, error}]},
%%       {lager_file_backend, [{file, "log/debugTest.log"}, {level, debug}]},
%%       {lager_file_backend, [{file, "log/TestResults.log"}, {level, emergency}]},
%%       {lager_file_backend, [{file, "log/consoleTest.log"}, {level, info}]}
%%     ]}
  ]},


  {exometer, [
  { report,
    [
      { subscribers,
        [
          {   exometer_report_statsd, [publish_proto, erlang, memory], total, 1000, true }
          , { exometer_report_statsd, [publish_proto, erlang, memory], processes, 1000, true }
          , { exometer_report_statsd, [publish_proto, erlang, memory], ets, 1000, true }
          , { exometer_report_statsd, [publish_proto, erlang, memory], binary, 1000, true }
          , { exometer_report_statsd, [publish_proto, erlang, memory], atom, 1000, true }
          , { exometer_report_statsd, [publish_proto, erlang, memory], system, 1000, true }

          , { exometer_report_statsd, [publish_proto, recon, alloc], used, 1000, true }
          , { exometer_report_statsd, [publish_proto, recon, alloc], allocated, 1000, true }
          , { exometer_report_statsd, [publish_proto, recon, alloc], unused, 1000, true }
          , { exometer_report_statsd, [publish_proto, recon, alloc], usage, 1000, true }

          , { exometer_report_statsd, [erlang, random, integer], max, 1000, true }
          , { exometer_report_statsd, [erlang, random, integer], mean, 1000, true }
          , { exometer_report_statsd, [erlang, random, integer], median, 1000, true }

          , { exometer_report_statsd, [publish_proto, publish, latency], max, 1000, true }
          , { exometer_report_statsd, [publish_proto, publish, latency], min, 1000, true }
          , { exometer_report_statsd, [publish_proto, publish, latency], median, 1000, true }
        ]},

      { reporters,
        [
          { exometer_report_statsd,
            [
              {hostname, "localhost"},
              {port, 8125},
              {type_map, [
                { [publish_proto, erlang, memory, total], gauge }
                , { [publish_proto, erlang, memory, processes], gauge }
                , { [publish_proto, erlang, memory, ets], gauge }
                , { [publish_proto, erlang, memory, binary], gauge }
                , { [publish_proto, erlang, memory, atom], gauge }
                , { [publish_proto, erlang, memory, system], gauge }

                , { [publish_proto, recon, alloc, used], gauge }
                , { [publish_proto, recon, alloc, allocated], gauge }
                , { [publish_proto, recon, alloc, unused], gauge }
                , { [publish_proto, recon, alloc, usage], gauge }

                , { [publish_proto, publish, latency, max], gauge }
                , { [erlang, random, integer, max], gauge }
                , { [erlang, random, integer, mean], gauge }
                , { [erlang, random, integer, median], gauge }

                , { [publish_proto, publish, latency, min], gauge }
                , { [publish_proto, publish, latency, median], gauge }
              ]}
            ]}
        ]}
    ]}
 ]}

].
